---
    layout:       post  
    title:        ListViewå°æ‹“å±•ï¼ˆä¸»è¦æ˜¯æˆ‘æƒ³å†™åµŒå¥—ï¼‰  
    subtitle:     ListViewçš„Itemç‚¹å‡»äº‹ä»¶ã€Itemç‚¹å‡»èƒŒæ™¯ã€ListViewåµŒå¥—GridView  
    date:         2021-07-20  
    auther:       BlackDn  
    header-img:   img/moriya_150_050.jpg    
    catalog:      true  
    tags:  
       - Android
---

> "æˆ‘æœ‰ä¸€å£¶é…’ï¼Œè¶³ä»¥æ…°é£å°˜ã€‚å°½å€¾æ±Ÿæµ·é‡Œï¼Œèµ é¥®å¤©ä¸‹äººã€‚"

# ListViewå°æ‰©å±•

## å‰è¨€

ä¹‹å‰å†™appçš„æ—¶å€™å†™ä¸€ä¸ªåˆ†ç±»+ä¸€å †ç‚¹å‡»æŒ‰é’®çš„é¡µé¢ï¼Œåº”è¯¥ä¼šæ”¾ä¸ªé¡µé¢æˆªå›¾åœ¨ä¸‹é¢åµŒå¥—çš„éƒ¨åˆ†  
ç„¶åå†™ç€å†™ç€æƒ³ï¼Œè¿™ç”¨åªç”¨ä¸ªListViewä¼¼ä¹æœ‰ç‚¹ç®€å•  
ä¸å¦‚æ˜¾æ‘†ä¸€ä¸‹ï¼Œç”¨ListViewåµŒå¥—GridViewå§ï¼  
ç„¶åæŠ˜è…¾äº†å¥½ä¹…ï¼ŒæŠŠè‡ªå·±éƒ½ç»•æ™•äº†ï¼Œæœ€åä¹Ÿç®—æˆåŠŸåµŒå¥—ï¼Œæ‰€ä»¥æœ‰äº†è¿™ç¯‡åšå®¢çš„å¤§éƒ¨åˆ†å†…å®¹  
åˆç„¶åè½¬å¿µä¸€æƒ³åªå†™ä¸ªåµŒå¥—å¥½åƒæ˜¾å¾—æ²¡ä»€ä¹ˆå†…å®¹å•Šï¼Œæ¯•ç«ŸåµŒå¥—ä¹Ÿæ²¡ä»€ä¹ˆéš¾ç‚¹ï¼Œå°±æ˜¯ListViewï¼ŒGridViewï¼ŒAdapterä»€ä¹ˆçš„å®¹æ˜“ç»•æ™•  
äºæ˜¯å°±åœ¨å‰é¢åˆé¡ºä¾¿å†™äº†ä¸€ä¸‹ListViewå…¶ä»–ä¸€äº›ç”¨æ³•å‡‘æ•°ã€‚ã€‚ã€‚

## ListViewçš„Itemç‚¹å‡»äº‹ä»¶

ListViewä¹Ÿæ²¡ä»€ä¹ˆç‰¹åˆ«çš„é€»è¾‘äº‹ä»¶ï¼Œä¸»è¦å°±æ˜¯å•å‡»å’Œé•¿æŒ‰ä¸¤ä¸ªäº‹ä»¶ï¼Œæ¯”è¾ƒç®€å•ï¼Œä¸»è¦å¯ä»¥åˆ†ä¸ºä¸‰æ­¥

1. å®ç°æ¥å£
2. è®¾ç½®ç›‘å¬å™¨
3. é‡å†™æ–¹æ³•

### å•å‡»ç‚¹å‡»äº‹ä»¶

å¯¹äºå•å‡»äº‹ä»¶ï¼Œæˆ‘ä»¬è¦å®ç°çš„æ¥å£æ˜¯ `AdapterView.OnItemClickListener`ï¼Œç„¶åé‡å†™ä»–çš„æŠ½è±¡æ–¹æ³• `onItemClick`   
ä¸€å…±æœ‰å››ä¸ªå‚æ•°ï¼Œçœ‹çœ‹[å®˜æ–¹æ–‡æ¡£](https://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener)

| å‚æ•°                       | ä½œç”¨                                                         |
| -------------------------- | ------------------------------------------------------------ |
| AdapterView<?> adapterView | ç‚¹å‡»æ‰€å‘ç”Ÿçš„AdapterView                                      |
| View view                  | AdapterViewé‡Œè¢«ç‚¹å‡»çš„å…·ä½“æ§ä»¶ï¼ˆç”±Adapteræä¾›çš„æ§ä»¶ï¼‰ï¼Œé€šå¸¸æ˜¯æˆ‘ä»¬çš„Item |
| int position               | æˆ‘ä»¬ç‚¹å‡»çš„Itemçš„ä½ç½®                                         |
| long id                    | æˆ‘ä»¬ç‚¹å‡»çš„Itemçš„ç¼–å·ï¼Œé€šå¸¸å’Œpositionç›¸åŒ                     |

é¡ºä¾¿è¡¥å……ä¸€ç‚¹ï¼ŒAdapterViewå…¶å®æ˜¯ViewGroupçš„ä¸€ä¸ªå­ç±»ï¼Œä¸ªäººç†è§£ä¸ºä¸€äº›éœ€è¦ç”¨çš„Adapterçš„æ§ä»¶ç±»ï¼Œæ¯”å¦‚ListViewã€GridViewç­‰éƒ½æ˜¯ä»–çš„åä»£ç±»ã€‚åƒ `setOnItemClickListener` è¿™ç§æ–¹æ³•éƒ½æ˜¯åœ¨ä»–é‡Œé¢çš„ï¼ˆæˆ‘å¥½åƒåœ¨å“ªé‡Œæåˆ°è¿‡è¿™ä¸ªç‚¹ä½†æ˜¯æˆ‘ä¸è®°å¾—äº†...ï¼‰

ç›‘å¬å™¨çš„è®¾ç½®ä¹Ÿç®€å•ï¼Œä¸€å¥è¯ `listView.setOnItemClickListener(this);`  
æœ€åæˆ‘ä»¬å°±å¯ä»¥åœ¨å¤–é¢å®ç°æ–¹æ³•äº†ï¼Œå®Œæ•´ä»£ç åƒè¿™æ ·ï¼šï¼ˆAdapterå°±å·æ‡’ï¼Œç…§ç€[ä¹‹å‰åšå®¢](https://blackdn.github.io/2021/04/09/Adapter-ArrayAdapter-SimpleAdapter-2021/)ç”¨ArrayAdapteräº†ï¼‰

```java
public class ListViewActivity extends AppCompatActivity implements AdapterView.OnItemClickListener {
    private ListView listView;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_list_view);
        
        String[] data = {"æˆ‘æ˜¯1", "æˆ‘æ˜¯2", "æˆ‘æ˜¯3","æˆ‘æ˜¯4", "æˆ‘æ˜¯5"};
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, data);

        listView = findViewById(R.id.list_view);
        listView.setAdapter(adapter);
        listView.setOnItemClickListener(this);
    }
    @Override
    public void onItemClick(AdapterView<?> adapterView, View view, int position, long id) {
        Toast.makeText(this, "click: " + position , Toast.LENGTH_SHORT).show();
    }
}
```

### é•¿æŒ‰ç‚¹å‡»äº‹ä»¶

é•¿æŒ‰ç‚¹å‡»äº‹ä»¶ä¹Ÿå¤§åŒå°å¼‚ï¼Œå°±æ˜¯æ–¹æ³•åå­—çš„å·®åˆ«ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç›´æ¥æ¥çœ‹ä»£ç ï¼š

```java
public class ListViewActivity extends AppCompatActivity implements AdapterView.OnItemClickListener
    , AdapterView.OnItemLongClickListener {
    private ListView listView;
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_list_view);

        String[] data = {"æˆ‘æ˜¯1", "æˆ‘æ˜¯2", "æˆ‘æ˜¯3","æˆ‘æ˜¯4", "æˆ‘æ˜¯5"};
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, data);

        listView = findViewById(R.id.list_view);
        listView.setAdapter(adapter);
        listView.setOnItemClickListener(this);
        listView.setOnItemLongClickListener(this);
    }
    @Override
    public void onItemClick(AdapterView<?> adapterView, View view, int position, long id) {
        Toast.makeText(this, "click: " + position , Toast.LENGTH_SHORT).show();
    }
    @Override
    public boolean onItemLongClick(AdapterView<?> adapterView, View view, int position, long id) {
        Toast.makeText(this, "long click: " + position , Toast.LENGTH_SHORT).show();
        return false;
    }
}
```

æ²¡é”™ï¼Œå°±æ˜¯æ–¹æ³•åé‡Œå¤šäº†ä¸ª `long` ã€‚  
å®ç°çš„æ¥å£åä¸º `AdapterView.OnItemLongClickListener ` ï¼Œè®¾ç½®çš„ç›‘å¬å™¨ä¸º `setOnItemLongClickListener`ï¼Œ é‡å†™çš„æ–¹æ³•æ˜¯ `onItemLongClick` ï¼Œå…¶ä»–çš„åŸºæœ¬ä¸€æ ·  
  
å½“ç„¶ç»†å¿ƒçš„ä½ å¯èƒ½å‘ç°äº†ï¼ˆæˆ‘ä¸æ˜¯è¯´ä½ æ²¡å‘ç°å°±ä¸ç»†å¿ƒçš„æ„æ€...ï¼‰ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ `boolean` ç±»å‹çš„ï¼Œè¿™åˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ  
å®é™…ä¸Šï¼Œè¿™é‡Œè¿”å›çš„ `true` å’Œ `false` ä»£è¡¨**â€œç‚¹å‡»äº‹ä»¶æ˜¯å¦è¢«æ¶ˆåŒ–â€** ã€‚  
å¦‚æœæ˜¯falseï¼Œä»£è¡¨ä¸æ¶ˆåŒ–ç‚¹å‡»äº‹ä»¶ï¼Œæ‰€ä»¥ç‚¹å‡»äº‹ä»¶è¿˜ä¼šç»§ç»­å‘ä¸‹ä¼ é€’ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬é•¿æŒ‰å®Œäº†åï¼Œå•å‡»äº‹ä»¶ä¼šç»§ç»­æ‰§è¡Œã€‚ä¸¾ä¸ªğŸŒ°ï¼Œæˆ‘ä»¬é•¿æŒ‰ç¬¬ä¸€ä¸ªitemç„¶åæ¾å¼€ã€‚å±å¹•ä¸Šå…ˆå‡ºç°é•¿æŒ‰çš„Toast â€œlong click: 0â€ï¼Œç„¶åå‡ºç°å•å‡»çš„Toast â€œclick: 0â€ï¼Œç›¸å½“äºåˆ¤å®šæˆ‘ä»¬æ—¢é•¿æŒ‰ï¼Œåˆå•å‡»ã€‚  
åŒæ ·çš„ï¼Œå¦‚æœæ˜¯trueï¼Œè¡¨ç¤ºç‚¹å‡»äº‹ä»¶è¢«æ¶ˆåŒ–ï¼Œä¸ä¼šç»§ç»­ä¼ é€’ï¼Œé•¿æŒ‰å®Œäº†å°±å®Œäº†ï¼Œå±å¹•åªä¼šå‡ºç°é•¿æŒ‰çš„Toast â€œlong click: 0â€ã€‚ï¼ˆå°±åƒé£Ÿç‰©åœ¨æ¶ˆåŒ–é“é‡Œä¸€æ ·ï¼Œ è¢«æ¶ˆåŒ–å¸æ”¶äº†å°±ä¸ä¼šå¾€ä¸‹èµ°äº†ï¼‰  
ä¸€èˆ¬éƒ½è®¾ç½®ä¸º `true` å•¦ã€‚

## åˆ©ç”¨Selectorè¿›è¡ŒItemç‚¹å‡»èƒŒæ™¯çš„åˆ‡æ¢

Selectorå¤§å®¶éƒ½ä¸é™Œç”Ÿï¼Œå› ä¸ºå®ƒ `state_pressed`ã€`state_checked`ç­‰å±æ€§ï¼Œèƒ½å¾ˆæ–¹ä¾¿åœ°é’ˆå¯¹æ§ä»¶çš„ä¸åŒçŠ¶æ€è¿›è¡Œä¿®æ”¹ï¼Œç‰¹åˆ«æ˜¯æŒ‰é’®èƒŒæ™¯ä¹‹ç±»çš„æ ·å¼ã€‚  
é‚£å¦‚æœæˆ‘æƒ³ä¿®æ”¹Itemçš„èƒŒæ™¯å‘¢ï¼Ÿä¸€èˆ¬ä¼šå¾ˆè‡ªç„¶åœ°æƒ³åˆ°æˆ‘è¦å»itemçš„å¸ƒå±€æ–‡ä»¶çš„æ ¹å¸ƒå±€ï¼Œä¿®æ”¹ `background` å±æ€§ï¼Œä½†è¿™æ ·å¾€å¾€ä¼šå‡ºç°ä¸€äº›æ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚  
ä»”ç»†ä¸€æƒ³æˆ‘ä»¬å¥½åƒä¹Ÿæ²¡æœ‰åœ¨æ ¹å¸ƒå±€é‡Œç»™ `background` å¢åŠ  Selectorï¼Œæ¯•ç«Ÿå› ä¸ºå¸ƒå±€çš„åµŒå¥—å¾€å¾€ä¼šå‡ºç°æ„æ–™ä¹‹å¤–çš„é”™è¯¯ã€‚æˆ‘ä»¬å¹³æ—¶éƒ½æ˜¯ç›´æ¥ä¿®æ”¹Buttonã€TextViewè¿™äº›å•ç‹¬æ§ä»¶çš„ `background`ã€‚é‚£å¯¹äºListViewçš„Itemè¦æ€ä¹ˆåŠå‘¢ï¼Ÿ

å…¶å®è¿™ç‚¹ListViewå·²ç»å¸®æˆ‘ä»¬è€ƒè™‘åˆ°äº†ï¼Œå°±æ˜¯ListViewè‡ªå¸¦çš„ä¸€ä¸ªå±æ€§ `listSelector` ã€‚å°†æˆ‘ä»¬çš„Selectoræ”¾åˆ°è¿™é‡Œï¼Œå°±ä¸ç”¨æ‹…å¿ƒå‡ºç°å¥‡å¥‡æ€ªæ€ªçš„æ„å¤–äº†ã€‚

```java
    <ListView
        android:id="@+id/list_view"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:listSelector="@drawable/listview_item_selector"/>
```



é¡ºä¾¿ä¸€æè¿™æ˜¯Selectorçš„ä»£ç ã€‚æœªè¢«ç‚¹å‡»å°±æ˜¯é€æ˜çš„ï¼ˆ`#00000000`ï¼‰ï¼Œè¢«ç‚¹å‡»äº†æˆ‘éšä¾¿æŒ‘äº†ä¸€ä¸ªé¢œè‰²ä½œä¸ºæ–°çš„èƒŒæ™¯ã€‚

```xml
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@color/transparent" android:state_pressed="false" />
    <item android:drawable="@color/purple_200" android:state_pressed="true" />
</selector>
```

å½“ç„¶ï¼Œå¦‚æœItemé‡Œé¢æœ‰Buttonæ§ä»¶çš„è¯ï¼ŒSelectorè¿˜å¯ä»¥ç”¨æ¥è‡ªå®šä¹‰Buttonçš„ç‚¹å‡»å‰åæ ·å¼ã€‚  
å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨è®¾ç½®Selectorä¹‹å‰ï¼Œå¦‚æœItemä¸­æœ‰Buttonçš„è¯ï¼Œç‚¹å‡»Itemå¯èƒ½ä¼šå‡ºç°æ²¡æœ‰åé¦ˆçš„æƒ…å†µï¼ŒItemçš„èƒŒæ™¯ä¸ä¼šæœ‰å˜åŒ–ï¼ˆé»˜è®¤æ˜¯ä¼šæ•´è¡Œå˜æˆç°è‰²çš„å§ï¼‰  
è¿™æ˜¯ç”±äºItemä¸­çš„Button**æŠ¢å¤ºç„¦ç‚¹**æ‰€å¯¼è‡´çš„ï¼Œéœ€è¦åœ¨Itemå¸ƒå±€çš„æœ€å¤–å±‚æ·»åŠ  `android:descendantFocusability=â€blocksDescendantsâ€` å±æ€§æ¥è§£å†³ã€‚  
è¿™ä¸€ç‚¹ä¹Ÿæ›¾åœ¨[ä¹‹å‰çš„åšå®¢](https://blackdn.github.io/2021/04/09/Adapter-ArrayAdapter-SimpleAdapter-2021/#%E8%BF%98%E6%9C%89item%E7%9A%84%E5%B8%83%E5%B1%80)é‡Œæåˆ°è¿‡ã€‚

## ListViewåµŒå¥—GridView

è¿™ä¸€éƒ¨åˆ†å°±æ˜¯æˆ‘ä¸»è¦æƒ³å†™çš„å†…å®¹å•¦ï¼Œæ‰€ä»¥å’Œä¸Šé¢çš„åŸºæœ¬æ²¡ä»€ä¹ˆå…³ç³»ï¼ŒåƒItemçš„å¸ƒå±€å•Šä»€ä¹ˆçš„éƒ½æ˜¯æ–°çš„äº†ã€‚

å…¶å®åªè¦å¼„æ¸…æ¥šå‡ ä¸ªView å’Œ Adapter ä¹‹é—´çš„å…³ç³»ï¼ŒListView åµŒå¥— GridView å¹¶æ²¡æœ‰ä»€ä¹ˆéš¾ç‚¹ï¼Œå°±æ˜¯æ¯”è¾ƒå®¹æ˜“å¼„æ··ï¼Œçœ‹ç€çœ‹ç€å¤´å°±æ™•äº†ã€‚  
è€ŒGridView å’Œ ListView å¤§åŒå°å¼‚ï¼Œä¸€ä¸ªæ˜¯ç½‘æ ¼å¸ƒå±€ï¼Œä¸€ä¸ªæ˜¯åˆ—è¡¨å¸ƒå±€ã€‚ä¸»è¦åŒºåˆ«åœ¨äºGridViewçš„ç‰¹æœ‰çš„ä¸€äº›å±æ€§ï¼Œæ¯”å¦‚`android:numColumns`è¡¨ç¤ºItemçš„åˆ—æ•°ï¼Œ`android:horizontalSpacing`è¡¨ç¤ºä¸¤åˆ—ä¹‹é—´çš„é—´éš”ï¼Œ`android:columnWidth`è¡¨ç¤ºä¸€åˆ—çš„å®½åº¦ç­‰ç­‰ï¼Œå…³äºGridViewçš„ä½¿ç”¨å°±ä¸ä»‹ç»äº†ï¼Œå…·ä½“å¯ä»¥çœ‹è¿™ä¸ªï¼š[GridViewåŸºæœ¬ä½¿ç”¨æ–¹æ³•](https://blog.csdn.net/qq_32534441/article/details/105884632)

### è‡ªä¸Šè€Œä¸‹åˆ†æ

å…ˆæ¥åˆ†æä¸€ä¸‹å’±ä»¬çš„é€»è¾‘ï¼Œæ¯•ç«Ÿæˆ‘å°±æ˜¯è¿™é‡Œè¢«ç»•æ™•çš„ã€‚å½“åˆå®ç°çš„ç»“æœå¤§è‡´æ˜¯è¿™æ ·ï¼Œç„¶åæˆ‘è¦å¼€å§‹bbäº†= =  

![Wdcrzd.png](https://z3.ax1x.com/2021/07/21/Wdcrzd.png)]  

#### ä» Activity åˆ° ListView çš„ Adapter

æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒListVie w è¯´åˆ°åº•åªæ˜¯ä¸€ä¸ªæ§ä»¶ï¼Œè€Œ Adapter ç”¨æ¥æŠŠæ•°æ®è½½å…¥åˆ° ListViewã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨ Activity ä¸­è¦åšçš„å…¶å®å°±ä¸¤ä»¶äº‹

1. æŠŠæ•°æ®ä¼ ç»™Adapter
2. è®© View ç»‘å®šAdapter

ç»“åˆæˆ‘ä»¬ ListView åµŒå¥— GridViewï¼Œç›¸å½“äº Activity ä¸­æœ‰ä¸ª **ListView** å’Œ **ListView çš„ Adapter**ï¼Œç„¶åæŠŠ**æ•°æ®**ä¼ ç»™ Adapterï¼Œè®© ListView ç»‘å®š Adapterã€‚

é‚£ä¹ˆ**æ•°æ®**æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ  
ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä¹‹å‰å­¦ [è‡ªå®šä¹‰Adapter](https://blackdn.github.io/2021/04/29/Adapter-Customed-2021/) çš„æ—¶å€™ï¼Œæ¯ä¸ª ListView çš„Itemå°±æ˜¯ä¸€ä¸ªå›¾ç‰‡åŠ ä¸€äº›æ–‡å­—ï¼Œæˆ‘ä»¬æŠŠå®ƒä»¬æ”¾åœ¨ä¸€ä¸ª HashMap é‡Œï¼Œä½œä¸ºä¸€ä¸ª Item çš„æ•°æ®ã€‚æœ€åæŠŠæ‰€æœ‰ HashMap ç»„æˆä¸€ä¸ª ArrayList ä¼ ç»™ Adatperã€‚åœ¨ Adapter ä¸­ï¼Œéå† ArrayList ä¾æ¬¡å–å‡ºæ¯ä¸ª HashMapï¼Œå†ä» HashMap ä¸­å–å‡ºæ•°æ®ä¼ ç»™ ListView çš„ Itemã€‚

æˆ‘ä»¬çš„ ListView çš„æ¯ä¸ª Item ä¸­ï¼Œæœ‰ä¸€ä¸ª**æ ‡é¢˜**å’Œä¸€ä¸ª **GridView** ï¼Œè€Œ GridView éœ€è¦çš„æ•°æ®å°±æ˜¯æ¯ä¸ª Item çš„æ–‡æœ¬ï¼ˆç›®å‰æ¯ä¸ª Item æ˜¯ä¸€ä¸ªæŒ‰é’®ï¼‰ï¼Œæ‰€ä»¥æˆ‘è¿™çš„æ•°æ®æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯ ä½œä¸º ListView çš„ Item æ ‡é¢˜çš„ `String[]` å’Œ ä½œä¸º GridView é‡Œæ¯ä¸ª Item æ•°æ®çš„ `ArrayList<ArrayList<HashMap<String, Object>>>`

å¥½äº†ï¼Œç°åœ¨æ•°æ®å·²ç»ä» Activity ä¼ åˆ°äº† ListView çš„Adapter ä¸­ã€‚æ‰€ä»¥æ¥ä¸‹æ¥è¦åœ¨ Adapter ä¸­åšäº‹äº†ã€‚

####  ListView çš„ Adapter åˆ° GridView çš„ Adapter

åœ¨ Adapter ä¸­åšäº‹ç›¸ä¿¡å¤§å®¶å·²ç»è½»è½¦ç†Ÿè·¯äº†ï¼Œæˆ‘ä»¬æ”¶åˆ°äº†ä¸Šé¢ä¼ è¿›æ¥çš„ä¸¤ç»„æ•°æ®ï¼Œæ ‡é¢˜æ‹¿å‡ºæ¥ç»™åˆ° ListView çš„ Item æ ‡é¢˜ï¼Œè€ŒArrayListåˆ™è¦é¢å¤–æ“ä½œä¸€ä¸‹ã€‚

å› ä¸º ArrayList é‡Œæ˜¯ GridView çš„æ•°æ®ï¼Œæˆ‘ä»¬è¦æŠŠä»–ä¼ åˆ° GridView çš„ Adapter ä¸­ã€‚ä¸€ä¸ª GridView æœ‰æœ‰å¾ˆå¤šä¸ªItemï¼Œæ‰€ä»¥ä¸€ä¸ª GridView çš„æ•°æ®æ˜¯ä¸€ä¸ª `ArrayList<HashMap<String, Object>>`ã€‚æˆ‘ä»¬æ”¶åˆ°çš„ `ArrayList<ArrayList<HashMap<String, Object>>>` åˆ™æ˜¯æ‰€æœ‰ GridView çš„æ•°æ®ï¼Œç›¸å½“äºæŠŠæ¯ä¸ª GridView ä¸€ä¸€æ”¾åˆ°åˆ—è¡¨é‡Œã€‚æ‰€ä»¥åœ¨è¿™é‡Œè¿˜è¦å¯¹è¿™ä¸ªåˆ—è¡¨è¿›è¡Œä¸ªè§£å°è£…ï¼Œå–å‡º `ArrayList<HashMap<String, Object>>` ä¼ ç»™ GridView çš„ Adapterï¼Œæ‰€ä»¥ GridView çš„ Adapter æ˜¯åœ¨è¿™é‡Œåˆ›å»ºçš„ã€‚

è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ ListView çš„ Item å’Œ GridView çš„ Item è¦åˆ†å¼€ä¸¤ç»„æ•°ç»„ï¼Œå› ä¸ºå‰è€…æ˜¯åœ¨ListViewAdapterä¸­è¿›è¡Œç»‘å®šï¼Œåè€…æ˜¯è¦ä¼ åˆ°GridViewAdapterä¸­è¿›ä¸€æ­¥æ“ä½œã€‚è¯´ç™½äº†å°±æ˜¯æŠŠ GridView çš„æ•°æ®é¢å¤–æ‹‰å‡ºæ¥ï¼Œä¼ ç»™ GridView çš„ Adapterã€‚

#### GridView çš„ Adapter

æ³¨æ„ï¼Œæˆ‘ä»¬ç°åœ¨æ”¶åˆ°çš„æ•°æ®æ˜¯å•ä¸ª GridView çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ `ArrayList<HashMap<String, Object>>`ï¼Œè¿™çœ‹èµ·æ¥å°±ç®€å•äº†ï¼Œå’Œå¹³æ—¶çš„ Adapter ç›¸å·®æ— å‡   
ç„¶åå–å‡ºä¸€ä¸ª HashMap å¯¹åº”ä¸€ä¸ª Item çš„æ•°æ®å³å¯ã€‚

æ€»ç»“ä¸€ä¸‹æ•°æ®æºï¼Œæ˜¯è¿™æ ·çš„ï¼š

1. HashMapï¼šæŸ GridView çš„ä¸€ä¸ª Item çš„æ•°æ®
2. ArrayList<HashMap<String, Object>>ï¼šå°†æ‰€æœ‰ HashMap ç»„æˆåˆ—è¡¨ï¼Œå³ä¸€ä¸ª GridView çš„æ•°æ®
3. ArrayList<ArrayList<HashMap<String, Object>>>ï¼šå°†æ¯ä¸ª GridView çš„æ•°æ®ç»„æˆåˆ—è¡¨ï¼Œå³ ListView çš„æ•°æ®

### è‡ªä¸‹è€Œä¸Šæ•²ç 

ä¸ºäº†é¿å…åœ¨å‡ ä¸ªç±»ä¸­è·³æ¥è·³å»æ¥å›åˆ‡æ¢ï¼Œæˆ‘ä»¬å°±è‡ªä¸‹è€Œä¸Šçœ‹çœ‹ä»£ç ï¼Œä¸è¿‡æœ€å¼€å§‹è¿˜æ˜¯å…ˆæå®šå¸ƒå±€ã€‚

#### å¸ƒå±€

##### 1. ä¸»é¡µé¢å¸ƒå±€ï¼šfragment_index.xml

å› ä¸ºæˆ‘çš„ä¸»é¡µé¢æ˜¯ Fragment è€Œé Activityï¼Œæ‰€ä»¥å¸ƒå±€ä¸º fragment_index.xmlï¼Œéå¸¸ç®€å•ï¼Œå°±ä¸€ä¸ª ListView

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent">
    <ListView
        android:id="@+id/index_listview"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:focusable="false"/>
</LinearLayout>
```

##### 2. ListViewçš„Itemå¸ƒå±€ï¼šitem_index_listview.xml

ListViewçš„Itemå¸ƒå±€æˆ‘å‘½åä¸ºitem_index_listview.xmlï¼Œæ­¤å¤„çš„NoScrollGridView

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent">
    <TextView
        android:id="@+id/index_listview_textview"
        android:text="@string/default_text"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:textSize="24sp"
        android:paddingLeft="15dp" />
    <com.example.mmmianjing.view.NoScrollGridView
        android:id="@+id/index_listview_item_gridview"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:stretchMode="columnWidth"
        android:verticalSpacing="15dp"
        android:numColumns="3"
        android:gravity="center"
        android:layout_marginBottom="20dp"
        android:layout_marginTop="10dp"/>
</LinearLayout>
```

##### 3. GridViewçš„Itemå¸ƒå±€ï¼šitem_index_listview.xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent">
    <Button
        android:id="@+id/index_gridview_button"
        android:text="@string/default_text"
        android:layout_width="100dp"
        android:layout_height="100dp"
        android:layout_gravity="center"
        android:textAllCaps="false"
        android:textColor="@color/black"/>
</LinearLayout>
```



#### GridViewçš„Adapter

è‡ªä¸‹è€Œä¸Šï¼Œæœ€åº•ä¸‹çš„æ˜¯ GridView çš„ Adapterï¼Œæˆ‘è¿™å‘½åMainListGridViewAdapterï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆè„‘å­æŠ½äº†èµ·è¿™ä¸ªåå­—ã€‚  
ä¸ºäº†~~å·æ‡’~~èŠ‚çœç¯‡å¹…ï¼Œ`getCount()`ç­‰æ–¹æ³•å°±ä¸å†™äº†ï¼Œå°±æ˜¯å¯¹æ•°æ®æº `gridDataSource` çš„é•¿åº¦åˆ¤å®šç­‰å†…å®¹ã€‚ä¸»ä½“è¿˜æ˜¯åœ¨ `getView()`æ–¹æ³•é‡Œã€‚

```java
public class MainListGridViewAdapter extends BaseAdapter {
    private Context context;
    private ArrayList<HashMap<String, Object>> gridDataSource;

    public MainListGridViewAdapter(Context context, ArrayList<HashMap<String, Object>> gridDataSource) {
        super();
        this.context = context;
        this.gridDataSource = gridDataSource;
    }
	//getCount(), getItem(), getItemId()...
    @Override
    public View getView(int position, View convertView, ViewGroup viewGroup) {
        ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = LayoutInflater.from(this.context).inflate(R.layout.item_index_listview_gridview, null, false);
            holder.button =convertView.findViewById(R.id.index_gridview_button);
            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        if (gridDataSource != null) {
            HashMap<String, Object> hashMap = gridDataSource.get(position);
            if (holder.button != null) {
                holder.button.setText(hashMap.get("content").toString());
                holder.button.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        //TODO: æŒ‰é’®ç‚¹å‡»
                    }
                });
            }
        }
        return convertView;
    }
    public class ViewHolder {
        Button button;
    }
}
```

æ¯”è¾ƒæ ‡å‡†çš„ä¸€ä¸ªè‡ªå®šä¹‰Viewï¼Œç»‘å®šå¸ƒå±€ã€ç»‘å®šæ§ä»¶ã€æ§ä»¶è®¾ç½®ï¼ˆè®¾ç½®æŒ‰é’®äº‹ä»¶ï¼‰ä¸€æ°”å‘µæˆï¼Œå› ä¸ºå¾ˆæ€•NPEæ‰€ä»¥åŠ äº†äº›éç©ºåˆ¤æ–­ã€‚  
æ¯ä¸ª GridView çš„ Item æ˜¯ä¸€ä¸ªæŒ‰é’®ï¼Œæˆ‘ä»¬ç»™æŒ‰é’®åŠ ä¸Šä¸ªæ–‡å­—å°±å¥½äº†ã€‚

#### ListViewçš„Adapter

å› ä¸º GridViewAdapter æ˜¯åœ¨ ListViewAdapter é‡Œå®ç°çš„ï¼Œæ•°æ®ä¹Ÿæ˜¯æ¥è‡ª ListViewAdapter ï¼Œå‘ä¸Šèµ°æˆ‘ä»¬æ¥å®ç° ListViewAdapter ã€‚æˆ‘å‘½åä¸ºMainListAdapterã€‚  
åŒæ ·ï¼Œ`getCount()` ç­‰æ–¹æ³•å°±ä¸å®ç°äº†ã€‚

```java
public class MainListAdapter extends BaseAdapter {
    private Context context;
    private ArrayList<ArrayList<HashMap<String, Object>>> listDataSource; 
    private  String[] topics;

    public MainListAdapter(Context context, ArrayList<ArrayList<HashMap<String, Object>>> listDataSource, String[] topics) {
        super();
        this.context = context;
        this.listDataSource = listDataSource;
        this.topics = topics;
    }
    @Override
    public View getView(int position, View convertView, ViewGroup viewGroup) {
        ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = LayoutInflater.from(this.context).inflate(R.layout.item_index_listview, null, false);
            holder.textView = convertView.findViewById(R.id.index_listview_textview);
            holder.gridView = convertView.findViewById(R.id.index_listview_item_gridview);
            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }
        ArrayList<HashMap<String, Object>> gridDataSource = listDataSource.get(position);
        MainListGridViewAdapter gridViewAdapter = new MainListGridViewAdapter(context, gridDataSource);
        holder.gridView.setAdapter(gridViewAdapter);
        holder.textView.setText(topics[position]);
        return convertView;
    }
    public class ViewHolder {
        TextView textView;
        GridView gridView;
    }
}
```

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æœ‰ä¸¤ç»„æ•°æ®ï¼Œåˆ†åˆ«æ˜¯ `String[] topics` å’Œ `ArrayList<ArrayList<HashMap<String, Object>>> listDataSource`  
å‰è€…æ˜¯ä¸ªå­—ç¬¦ä¸²çš„æ ‡é¢˜ï¼Œæˆ‘ä»¬ç”¨ `holder.textView.setText(topics[position]);` ä¼ ç»™TextViewï¼Œåè€…åˆ™æ˜¯æ‰€æœ‰ GridView çš„æ•°æ®ã€‚  
ä½†æ˜¯æˆ‘ä»¬çš„ GridViewAdapter æ˜¯åœ¨ `getView()` æ–¹æ³•é‡Œå®ç°çš„ï¼Œç„¶åç»™å½“å‰çš„ GridView ç»‘å®šï¼Œå› æ­¤æˆ‘ä»¬ä¼ ç»™ GridView çš„æ•°æ®åªç”¨æ˜¯ä¸€ä¸ª GridView çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆ `listDataSource.get(position)` æ¥å¾—åˆ°ä¸€ä¸ª GridView çš„æ•°æ®ï¼Œç„¶åä¼ ç»™ GridViewAdapter å°±å¥½äº†ã€‚

ç»™ GridViewAdapter ä¼ å…¥æ•°æ®åï¼Œæœ€åç»™ ViewHolder ä¸­æ¯ä¸ª GridView ç»‘å®šè¿™ä¸ªä¼ å®Œæ•°æ®çš„ GridViewAdapter å°±å®Œäº‹äº†ã€‚

#### MainActivityä¸­ï¼ˆæˆ‘è¿™æ˜¯Fragmentï¼‰

æœ€åæ¥åˆ°MainActivityä¸­ï¼Œä¸è¿‡æˆ‘è¿™æ˜¯Fragmentï¼Œç›¸ä¿¡å¤§å®¶éƒ½èƒ½çœ‹æ‡‚ã€‚

```java
public class IndexFragment extends Fragment {
    private ListView listView;
    private MainListAdapter listAdapter;
    private ArrayList<ArrayList<HashMap<String, Object>>> listViewDataSource;
    private final String[] TOPICS = new String[]{"AndroidåŸºç¡€çŸ¥è¯†", "javaåŸºç¡€çŸ¥è¯†", "è®¡ç®—æœºåŸºç¡€", "ä»£ç "};
    private final String[][] SUBJECTS = new String[][]{
            {"å››å¤§ç»„ä»¶", "è‡ªå®šä¹‰View & åŠ¨ç”»", "æ€§èƒ½ä¼˜åŒ–", "IPC", "WebView"},
            {"javaç‰¹æ€§", "javaåŸºç¡€", "æŠ½è±¡ç±»åŠæ¥å£", "JVM", "javaå®¹å™¨ç±»","javaå¤šçº¿ç¨‹"},
            {"æ•°æ®ç»“æ„", "è®¡ç®—æœºç½‘ç»œ", "æ“ä½œç³»ç»Ÿ"},
            {"é“¾è¡¨", "æ ˆ&é˜Ÿåˆ—&å †", "é€’å½’&å›æº¯&åˆ†æ²»", "åŠ¨æ€è§„åˆ’", "è´ªå¿ƒç®—æ³•"}};
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_index, container, false);
        listView = view.findViewById(R.id.index_listview);
        listViewDataSource = new ArrayList<>();
        for (int i = 0; i < TOPICS.length; i++) {
            ArrayList<HashMap<String, Object>> gridViewDataSource = new ArrayList<>();  //ä¸€ä¸ªgridviewçš„æ•°æ®æº
            for (int j = 0; j < SUBJECTS[i].length; j++) {
                HashMap<String, Object> gridViewItemDataSource = new HashMap<>();   //gridviewæ¯ä¸ªitemçš„æ•°æ®æº
                gridViewItemDataSource.put("content", SUBJECTS[i][j]);
                gridViewDataSource.add(gridViewItemDataSource);
            }
            listViewDataSource.add(gridViewDataSource);
        }
        listAdapter = new MainListAdapter(getContext(), listViewDataSource, TOPICS);
        listView.setAdapter(listAdapter);
        return view;
    }
}
```

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ä¸€å¼€å§‹å‡†å¤‡äº†ä¸¤ä¸ªæ•°æ®æºï¼Œåˆ†åˆ«æ˜¯ ListView çš„ Item æ ‡é¢˜ `TOPICS` å’Œ GridView çš„æ•°æ®ï¼ˆæŒ‰é’®çš„æ–‡å­—ï¼‰ `SUBJECTS`ã€‚  
è€Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†`SUBJECTS` é€ä¸ªæ”¾å…¥ HashMap ä¸­ï¼Œå†å°† HashMap ä¸²æˆåˆ—è¡¨ã€æŠŠåˆ—è¡¨ä¸²æˆåˆ—è¡¨......æ€»ä¹‹å°±æ˜¯æŠŠæ•°æ®é€æ­¥å°è£…è¿› `ArrayList<ArrayList<HashMap<String, Object>>> listViewDataSource` ä¼ åˆ°ListViewçš„Adapterä¸­ã€‚   
è‡³äº `TOPICS` ï¼Œå°±ç›´æ¥ä¼ ç»™Adapteräº†ã€‚

## åè®°

å•Šå“ˆå“ˆï¼Œå‘è¶Šæ¥è¶Šå¤šï¼Œå†™è¶Šæ¥è¶Šæ‡’å¾—å†™(âœ¿â—¡â€¿â—¡)  
è¿™ä¸€ç¯‡å…¶å®æˆ‘ä¸ªäººä¹Ÿä¸æ˜¯ç‰¹åˆ«æ»¡æ„ï¼Œå› ä¸ºå¹²è´§æŒºå°‘ï¼Œæ¯”è¾ƒæ°´çš„ä¸€ç¯‡  
ä¸‹æ¬¡ä¸€å®šï¼

## å‚è€ƒ

1. [å­™è€å¸ˆè¯¾å ‚](https://www.bilibili.com/video/BV1Mx411L7DV)
2. [developersï¼šAdapterView.OnItemClickListener](https://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener)
3. [ListViewåµŒå¥—GridViewä½¿ç”¨è¯¦è§£](https://it9527.blog.csdn.net/article/details/9156241)
4. [GridViewåŸºæœ¬ä½¿ç”¨æ–¹æ³•](https://blog.csdn.net/qq_32534441/article/details/105884632)
5. [Adapterï¼šArrayAdapterå’ŒSimpleAdapteré€‚é…ListView](https://blackdn.github.io/2021/04/09/Adapter-ArrayAdapter-SimpleAdapter-2021/)

